<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>SAP Beats Challenge</title>
<style>
:root {
--sap-blue: #0077C6; /* Azul principal de SAP /
--sap-light-blue: #ADD8E6; / Azul claro de SAP */
--dark-background: #1E1E1E;
--glow-color: var(--sap-light-blue);
--score-color: #FFFFFF;
}

body {
  margin: 0;
  font-family: 'Segoe UI', sans-serif;
  background-color: var(--dark-background);
  color: white;
  text-align: center;
  padding: 20px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-around;
  min-height: 100vh;
  box-sizing: border-box;
}

/* --- Overlay de Inicio --- */
#overlay-start {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(30, 30, 30, 0.9); backdrop-filter: blur(8px);
  z-index: 10000; display: flex; flex-direction: column;
  justify-content: center; align-items: center; padding: 25px;
  box-sizing: border-box; transition: opacity 0.5s ease-out;
}
#overlay-start.hidden { opacity: 0; pointer-events: none; }
.overlay-content { max-width: 400px; }
.overlay-content h2 { font-size: 28px; color: var(--sap-blue); text-shadow: 0 0 8px var(--sap-blue); }
.overlay-content p { font-size: 18px; line-height: 1.6; }
#startButton {
  margin-top: 25px; padding: 15px 30px; font-size: 20px; font-weight: bold;
  color: var(--dark-background); background-color: var(--sap-blue);
  border: none; border-radius: 10px; cursor: pointer;
  box-shadow: 0 0 15px var(--sap-blue), 0 0 25px var(--sap-blue);
  transition: transform 0.2s, box-shadow 0.2s;
}
#startButton:hover { transform: scale(1.05); }

/* --- Overlay de Resultados --- */
#overlay-results {
  position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(30, 30, 30, 0.95); backdrop-filter: blur(10px);
  z-index: 10001; display: flex; flex-direction: column;
  justify-content: center; align-items: center; padding: 25px;
  box-sizing: border-box; opacity: 0; pointer-events: none;
  transition: opacity 0.5s ease-in-out;
}
#overlay-results.visible { opacity: 1; pointer-events: auto; }
.results-content {
  text-align: center;
}
.results-content h2 {
  font-size: 3em; color: var(--score-color);
  text-shadow: 0 0 10px var(--glow-color);
  margin-bottom: 15px;
}
.results-content p {
  font-size: 1.5em; opacity: 0.8;
}

/* --- Contenido Principal --- */
.app-header { margin-bottom: 20px; }
.logo { max-width: 180px; opacity: 0.9; }

.music-note-container {
  width: 80%; max-width: 150px;
  filter: drop-shadow(0 0 5px var(--glow-color)) drop-shadow(0 0 15px var(--glow-color));
  animation: breathing 4s ease-in-out infinite;
}

@keyframes breathing {
  0%, 100% { filter: drop-shadow(0 0 5px var(--glow-color)) drop-shadow(0 0 15px var(--glow-color)); transform: scale(1); }
  50% { filter: drop-shadow(0 0 10px var(--glow-color)) drop-shadow(0 0 25px var(--glow-color)); transform: scale(1.03); }
}

.beats-info { font-size: 1.5em; margin-top: 15px; text-shadow: 0 0 5px var(--glow-color); }
.timer { font-size: 2.5em; font-weight: bold; color: var(--sap-blue); text-shadow: 0 0 10px var(--sap-blue); margin-top: 10px; }
.hint { font-size: 16px; margin-top: 10px; opacity: 0.7; }
.footer { position: absolute; bottom: 10px; font-size: 12px; opacity: 0.4; }

#confetti-canvas {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 9999;
}
</style>
</head>
<body>

<div id="overlay-start">
<div class="overlay-content">
<h2>¬°Desaf√≠o SAP Beats! ü•Å</h2>
<p>¬°Agita tu celular lo m√°s r√°pido que puedas durante <span style="color: var(--sap-blue); font-weight: bold;">10 segundos</span> para generar la mayor cantidad de beats y encender la nota musical!</p>
<p>Al finalizar, ver√°s tu puntuaci√≥n y podr√°s acceder al sorteo de incre√≠bles premios.</p>
<button id="startButton">¬°A rockear!</button>
</div>
</div>

<div id="overlay-results">
<div class="results-content">
<h2 id="final-beats"></h2>
<p>¬°Prep√°rate para el sorteo!</p>
</div>
</div>

<canvas id="confetti-canvas"></canvas>

<header class="app-header">
<img class="logo" src="https://www.sap.com/dam/application/shared/logos/sap-logo.svg" alt="SAP Logo" />
</header>

<p class="hint">¬°Prep√°rate para agitar!</p>
<div class="timer" id="timer"></div>
<div class="beats-info">Beats Generados: <span id="beatCounter">0</span></div>

<div class="music-note-container">
<svg id="elegantQuaver" viewBox="0 0 150 250" xmlns="http://www.w3.org/2000/svg">
<defs>
<linearGradient id="fillGradient" x1="0%" y1="100%" x2="0%" y2="0%">
<stop id="fillStop1" offset="100%" stop-color="var(--sap-blue)" />
<stop id="fillStop2" offset="100%" stop-color="rgba(30, 30, 30, 0.2)" />
</linearGradient>
<filter id="neonGlow" x="-20%" y="-20%" width="140%" height="140%" filterUnits="objectBoundingBox">
<feGaussianBlur stdDeviation="3" in="SourceAlpha" result="blur" />
<feComponentTransfer in="blur" result="glow">
<feFuncA type="linear" slope="2" intercept="0"/>
</feComponentTransfer>
<feMerge>
<feMergeNode in="glow" />
<feMergeNode in="SourceGraphic" />
</feMerge>
</filter>
</defs>
<path
d="M 88.1 13.4c-14.5 9.9-24.3 35-19.9 54.8l1.1 0.7v135.1c0 10.8-6.1 20.3-16.2 20.3-13.5 0-24.4-9.3-24.4-29.7 0-20.4 10.9-30.9 24.4-30.9 3.4 0 6.7 0.5 9.9 1.8V15.6c-11.6-13.6-9.9-39.5 12.4-53.1 3.6-2.1 7.7-3.2 12-3.2 3.1 0 6 0.8 8.4 2.2z"
fill="url(#fillGradient)" stroke="var(--glow-color)" stroke-width="4" filter="url(#neonGlow)" />
</svg>
</div>

<div class="footer">SAP Beats Challenge</div>

<audio id="sound-guitar" src="https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const DOMElements = {
overlayStart: document.getElementById('overlay-start'),
overlayResults: document.getElementById('overlay-results'),
startButton: document.getElementById('startButton'),
beatCounter: document.getElementById('beatCounter'),
fillStop1: document.getElementById('fillStop1'),
fillStop2: document.getElementById('fillStop2'),
timerDisplay: document.getElementById('timer'),
finalBeatsDisplay: document.getElementById('final-beats'),
notePath: document.querySelector('.music-note-container svg path'),
};

const Sounds = {
    guitar: document.getElementById(&#39;sound-guitar&#39;),
};
Sounds.guitar.loop = true;

const GameState = {
    beats: 0,
    maxBeats: 1000, // Cantidad visual para el llenado
    isGameActive: false,
    startTime: 0,
    endTime: 0,
    timeLeft: 10,
    shakeInterval: null,
    confettiLauncher: confetti.create(document.getElementById(&#39;confetti-canvas&#39;), { resize: true }),
};

function startGame() {
    DOMElements.overlayStart.classList.add(&#39;hidden&#39;);
    GameState.beats = 0;
    DOMElements.beatCounter.innerText = 0;
    GameState.isGameActive = true;
    GameState.startTime = Date.now();
    GameState.timeLeft = 10;
    DOMElements.timerDisplay.innerText = GameState.timeLeft;
    Sounds.guitar.play().catch(() =&gt; {});

    GameState.shakeInterval = setInterval(() =&gt; {
        if (GameState.timeLeft &lt;= 0) {
            endGame();
            return;
        }
        GameState.timeLeft--;
        DOMElements.timerDisplay.innerText = GameState.timeLeft;
    }, 1000);
}

function handleMotion(event) {
    if (!GameState.isGameActive) return;
    const acc = event.accelerationIncludingGravity;
    const shakePower = Math.abs(acc.x) + Math.abs(acc.y) + Math.abs(acc.z);

    if (shakePower &gt; 30) {
        GameState.beats++;
        DOMElements.beatCounter.innerText = GameState.beats;
        // Puedes a√±adir aqu√≠ una l√≥gica para un feedback visual m√°s inmediato si lo deseas
    }
    if (Math.abs(acc.x) &lt; 2 &amp;&amp; Math.abs(acc.y) &lt; 2 &amp;&amp; Math.abs(acc.z) &lt; 2) {
        Sounds.guitar.pause();
    } else if (Sounds.guitar.paused) {
        Sounds.guitar.play().catch(() =&gt; {});
    }
}

function endGame() {
    GameState.isGameActive = false;
    clearInterval(GameState.shakeInterval);
    Sounds.guitar.pause();

    // Llenar la corchea visualmente
    let fillPercent = 100;
    DOMElements.fillStop1.setAttribute(&#39;offset&#39;, fillPercent + &#39;%&#39;);
    DOMElements.fillStop2.setAttribute(&#39;offset&#39;, fillPercent + &#39;%&#39;);

    DOMElements.finalBeatsDisplay.innerText = `${GameState.beats} Beats!`;
    DOMElements.overlayResults.classList.add(&#39;visible&#39;);
    launchConfetti();

    setTimeout(() =&gt; {
        window.location.href = &#39;[https://forms.gle/VvtAHk7RNg5DyYM3A](https://forms.gle/VvtAHk7RNg5DyYM3A)&#39;;
    }, 3000);
}

function launchConfetti() {
    const end = Date.now() + (3 * 1000);
    const colors = [&#39;#0077C6&#39;, &#39;#ADD8E6&#39;, &#39;#FFFFFF&#39;];

    (function frame() {
      confetti({
        particleCount: 200,
        angle: 60,
        spread: 55,
        origin: { x: 0 },
        colors: colors
      });
      confetti({
        particleCount: 200,
        angle: 120,
        spread: 55,
        origin: { x: 1 },
        colors: colors
      });

      if (Date.now() &lt; end) {
        requestAnimationFrame(frame);
      }
    }());
}

DOMElements.startButton.addEventListener(&#39;click&#39;, startGame);

if (window.DeviceMotionEvent) {
    window.addEventListener(&#39;devicemotion&#39;, handleMotion);
} else {
    alert(&#39;Tu dispositivo no soporta el sensor de movimiento.&#39;);
}
</script>

</body>
</html>
